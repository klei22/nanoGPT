# explorations/l2_norm_mlp_projections.yaml
---
parameter_groups:
  - l2_norm_mlp_up: [false]
    l2_norm_mlp_down: [false]
    print_model_stats_table: ["no_l2_norm.csv"]
  - l2_norm_mlp_up: [true]
    l2_norm_mlp_up_dim: ["embed"]
    l2_norm_mlp_down: [false]
    print_model_stats_table: ["up_embed.csv"]
  - l2_norm_mlp_up: [true]
    l2_norm_mlp_up_dim: ["hidden"]
    l2_norm_mlp_down: [false]
    print_model_stats_table: ["up_hidden.csv"]
  - l2_norm_mlp_up: [false]
    l2_norm_mlp_down: [true]
    l2_norm_mlp_down_dim: ["embed"]
    print_model_stats_table: ["down_embed.csv"]
  - l2_norm_mlp_up: [false]
    l2_norm_mlp_down: [true]
    l2_norm_mlp_down_dim: ["hidden"]
    print_model_stats_table: ["down_hidden.csv"]
  - l2_norm_mlp_up: [true]
    l2_norm_mlp_up_dim: ["embed"]
    l2_norm_mlp_down: [true]
    l2_norm_mlp_down_dim: ["embed"]
    print_model_stats_table: ["up_embed_down_embed.csv"]
  - l2_norm_mlp_up: [true]
    l2_norm_mlp_up_dim: ["embed"]
    l2_norm_mlp_down: [true]
    l2_norm_mlp_down_dim: ["hidden"]
    print_model_stats_table: ["up_embed_down_hidden.csv"]
  - l2_norm_mlp_up: [true]
    l2_norm_mlp_up_dim: ["hidden"]
    l2_norm_mlp_down: [true]
    l2_norm_mlp_down_dim: ["embed"]
    print_model_stats_table: ["up_hidden_down_embed.csv"]
  - l2_norm_mlp_up: [true]
    l2_norm_mlp_up_dim: ["hidden"]
    l2_norm_mlp_down: [true]
    l2_norm_mlp_down_dim: ["hidden"]
    print_model_stats_table: ["up_hidden_down_hidden.csv"]

# base hyperparameters
max_iters: [250]
n_layer: [6]
n_head: [6]
n_embd: [384]
block_size: [256]
device: ["cuda"]
dtype: ["bfloat16"]
dataset: ["shakespeare_char"]

# training options
compile: [true]
never_save_checkpoint: [true]
use_rotary_embeddings: [true]
use_abs_pos_embeddings: [false]
use_qk_norm: [true]
use_qk_norm_scale: [true]
use_peri_ln: [true, false]
compute_model_stats: [true]
