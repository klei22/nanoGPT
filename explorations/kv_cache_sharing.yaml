# explorations/kv_cache_sharing.yaml
# Sweep KV-cache sharing patterns vs vanilla, along with MLP/Attn parameter sharing
# Based on explorations/config.yaml template

# --- dataset & compute ---
dataset: ["shakespeare_char"]
device: ["cuda"]
compile: [true]
dtype: ["float16"]

# --- base model hyper-params (SMALL net) ---
n_embd: [384]
n_head: [6]
max_iters: [2000]
eval_interval: [250]

# explore both odd/even layer counts
n_layer: [5, 6]

# --- KV-cache sharing variants ---
kv_cache_sharing: [null, "group", "cycle", "symmetric"]
kv_cache_group_size: [1, 2]
kv_cache_num_slots: [1, 2, 3]

# --- Parameter sharing for attention & MLP ---
shared_attn_size: [1, 2]
shared_attn_seq: [1, 2]
shared_attn_sym: [false, true]

shared_mlp_size: [1, 2]
shared_mlp_seq: [1, 2]
shared_mlp_sym: [false, true]
