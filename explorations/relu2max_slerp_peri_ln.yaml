# relu2max_slerp_peri_ln.yaml
---
parameter_groups:
  - softmax_variant_attn: ["relu2max"]
    attn_residual_combination: ["slerp"]
    mlp_residual_combination: ["slerp"]
    tensorboard_run_name: ["relu2max_slerp_attn_mlp"]
    print_model_stats_table: ["relu2max_slerp_attn_mlp.csv"]
  - softmax_variant_attn: ["relu2max"]
    attn_residual_combination: ["slerp"]
    mlp_residual_combination: ["add"]
    use_peri_ln: [true]
    tensorboard_run_name: ["relu2max_slerp_attn_peri_mlp"]
    print_model_stats_table: ["relu2max_slerp_attn_peri_mlp.csv"]
  - softmax_variant_attn: ["relu2max"]
    attn_residual_combination: ["add"]
    mlp_residual_combination: ["add"]
    use_peri_ln: [true]
    tensorboard_run_name: ["relu2max_add_peri_mlp"]
    print_model_stats_table: ["relu2max_add_peri_mlp.csv"]
  - softmax_variant_attn: ["softmax"]
    attn_residual_combination: ["add"]
    mlp_residual_combination: ["add"]
    use_peri_ln: [true]
    tensorboard_run_name: ["softmax_peri_ln"]
    print_model_stats_table: ["softmax_peri_ln.csv"]

use_qk_norm: [true]
use_qk_norm_scale: [true]
max_iters: [250]
n_layer: [6]
n_head: [6]
n_embd: [384]
block_size: [256]
device: ["cuda"]
dtype: ["bfloat16"]
dataset: ["shakespeare_char"]

# residual alpha strategies
attn_residual_alpha_type: ["fixed", "learned", "dot"]
mlp_residual_alpha_type: ["fixed", "learned", "dot"]

compute_model_stats: [true]
compile: [true]
